# OSI参照モデル 7階層まとめ

## OSI参照モデルとは

OSI参照モデル（Open Systems Interconnection Reference Model）は、国際標準化機構（ISO）によって1984年に策定された、ネットワーク通信を7つの階層（レイヤー）に分けて整理した概念モデルです。

異なるコンピュータシステムが相互に通信するために必要なアクティビティとプロセスを明確化し、各プロトコルの役割を分類するための標準的な枠組みです。

---

## OSI 7階層の概要

```
┌─────────────────────────────────┐
│ 第7層: アプリケーション層          │ ← ユーザーに近い層
│      (Application Layer)         │   (上位層)
├─────────────────────────────────┤
│ 第6層: プレゼンテーション層        │
│      (Presentation Layer)        │
├─────────────────────────────────┤
│ 第5層: セッション層               │
│      (Session Layer)             │
├─────────────────────────────────┤
│ 第4層: トランスポート層            │
│      (Transport Layer)           │
├─────────────────────────────────┤
│ 第3層: ネットワーク層              │
│      (Network Layer)             │
├─────────────────────────────────┤
│ 第2層: データリンク層              │
│      (Data Link Layer)           │
├─────────────────────────────────┤
│ 第1層: 物理層                     │ ← ハードウェアに近い層
│      (Physical Layer)            │   (下位層)
└─────────────────────────────────┘
```

---

## 第7層: アプリケーション層 (Application Layer)

### 役割
- **ユーザーとネットワークアプリケーションが直接やり取りを行う層**
- エンドユーザーが実際に利用するネットワークサービスを提供
- アプリケーション間のデータ交換を可能にする

### 主な機能
- ネットワークサービスの提供
- ファイル転送
- メール送受信
- Webページの表示
- リモートアクセス

### 代表的なプロトコル
| プロトコル | 用途 |
|-----------|------|
| HTTP/HTTPS | Webページの閲覧 |
| FTP | ファイル転送 |
| SMTP | メール送信 |
| POP3/IMAP | メール受信 |
| DNS | ドメイン名解決 |
| DHCP | IPアドレス自動割り当て |
| SSH | 安全なリモートアクセス |
| Telnet | リモート端末接続 |

### 対応する機器・ソフトウェア
- Webブラウザ
- メールクライアント
- FTPクライアント
- **ゲートウェイ（一部）**

---

## 第6層: プレゼンテーション層 (Presentation Layer)

### 役割
- **データの形式を標準化し、異なるシステム間でデータを共通の形式に変換**
- データの表現方法を管理

### 主な機能
- データのエンコード・デコード
- データ形式の変換
- 文字コード変換（ASCII、EBCDIC、Unicode等）
- データ圧縮・解凍
- 暗号化・復号化

### 代表的なプロトコル・技術
| 技術 | 用途 |
|------|------|
| SSL/TLS | データの暗号化 |
| JPEG | 画像圧縮 |
| MPEG | 動画圧縮 |
| ASCII | 文字コード |
| Unicode | 国際文字コード |
| MIME | メールの添付ファイル形式 |

### 対応する機器
- **ゲートウェイ（一部）**
- 暗号化装置

---

## 第5層: セッション層 (Session Layer)

### 役割
- **通信の開始から終了までのセッション（対話）を管理**
- アプリケーション間の論理的な接続を確立・維持・終了

### 主な機能
- セッションの確立
- セッションの維持
- セッションの終了
- 同期点の設定（通信の再開ポイント）
- ダイアログ制御（全二重・半二重通信の制御）

### 代表的なプロトコル
| プロトコル | 用途 |
|-----------|------|
| NetBIOS | ネットワーク上の名前解決 |
| RPC | リモートプロシージャコール |
| PPTP | VPN接続 |
| SQL | データベース接続セッション |

### 対応する機器
- **ゲートウェイ（一部）**

---

## 第4層: トランスポート層 (Transport Layer)

### 役割
- **エンドツーエンドの信頼性のある通信を保証**
- データの分割・再構築
- エラー検出と訂正

### 主な機能
- データの分割（セグメント化）
- データの再構築
- エラー検出・再送制御
- フロー制御（送信速度の調整）
- ポート番号による通信の識別
- 通信品質の保証

### 代表的なプロトコル
| プロトコル | 特徴 | 用途 |
|-----------|------|------|
| **TCP** (Transmission Control Protocol) | 信頼性重視・接続型・エラー訂正あり | Web、メール、ファイル転送 |
| **UDP** (User Datagram Protocol) | 速度重視・非接続型・エラー訂正なし | 動画ストリーミング、DNS、VoIP |

### TCPとUDPの違い

```
【TCP - 信頼性重視】
送信側                    受信側
  │                         │
  ├──→ データ1 ──→────┤
  │    ←── ACK ←──────┤  ← 受信確認
  ├──→ データ2 ──→────┤
  │    ←── ACK ←──────┤

特徴: 確実に届く、順序保証、遅い


【UDP - 速度重視】
送信側                    受信側
  │                         │
  ├──→ データ1 ──→────┤
  ├──→ データ2 ──→────┤
  ├──→ データ3 ──→────┤

特徴: 届かない可能性あり、速い
```

### 対応する機器
- **ゲートウェイ（一部）**
- L4スイッチ（レイヤ4スイッチ）

---

## 第3層: ネットワーク層 (Network Layer)

### 役割
- **異なるネットワーク間での通信経路を選択（ルーティング）**
- パケットを宛先まで届けるための論理的なアドレス（IPアドレス）を管理

### 主な機能
- 経路選択（ルーティング）
- 論理アドレス（IPアドレス）の管理
- パケットの転送
- ネットワーク間の中継
- パケットの分割・再構築（フラグメンテーション）

### 代表的なプロトコル
| プロトコル | 用途 |
|-----------|------|
| **IP** (Internet Protocol) | パケット転送の基本プロトコル |
| IPv4 | 32ビットIPアドレス（例: 192.168.1.1） |
| IPv6 | 128ビットIPアドレス（例: 2001:db8::1） |
| ICMP | エラー通知、ping |
| ARP | IPアドレス→MACアドレス変換 |
| IGMP | マルチキャスト通信の管理 |

### 対応する機器
| 機器名 | 説明 |
|--------|------|
| **ルータ (Router)** | パケットのIPアドレス情報を使って、ネットワーク間を中継する |
| **L3スイッチ** (レイヤ3スイッチ) | ルータの機能をハードウェアで高速化した機器 |

### ルーティングの仕組み

```
【ルータによるパケット転送】

ネットワークA          ルータA          ネットワークB
192.168.1.0/24                        10.0.0.0/24
    │                    │                 │
┌───▼───┐          ┌───▼───┐      ┌───▼───┐
│ PC-A     │          │ルーティング│      │ PC-B     │
│192.168.1.10│ ──→  │テーブル   │ ──→ │10.0.0.50 │
└──────────┘          └──────────┘      └──────────┘

ルータは宛先IPアドレスを見て、
適切な転送先を選択（ルーティング）
```

---

## 第2層: データリンク層 (Data Link Layer)

### 役割
- **直接接続された機器間の信頼性のあるデータ転送**
- 物理的なアドレス（MACアドレス）を使った通信制御

### 主な機能
- MACアドレスによる機器の識別
- フレームの生成・送受信
- エラー検出（CRC）
- フロー制御
- アクセス制御（CSMA/CD）
- セグメント間の中継

### 代表的なプロトコル・技術
| 技術 | 用途 |
|------|------|
| **Ethernet** | 有線LANの標準規格 |
| Wi-Fi (IEEE 802.11) | 無線LANの標準規格 |
| PPP | ポイントツーポイント接続 |
| HDLC | WAN接続 |
| MAC (Media Access Control) | メディアアクセス制御 |

### 対応する機器
| 機器名 | 説明 |
|--------|------|
| **ブリッジ (Bridge)** | MACアドレス情報を使って、セグメント間を中継する |
| **スイッチングハブ** (L2スイッチ) | MACアドレスをもとに、宛先だけにデータを送信 |
| **NIC** (Network Interface Card) | ネットワークに接続するための拡張カード、MACアドレスを持つ |
| 無線LANアクセスポイント | 無線通信の中継 |

### MACアドレスとは

```
MACアドレスの例: AA:BB:CC:DD:EE:FF
                 └──┬──┘ └──┬──┘
                 ベンダーID  製造番号

- NICに製造段階で割り当てられる固有の番号
- 世界中で重複しない（理論上）
- 48ビット（6バイト）の16進数で表現
- イーサネットではMACアドレスで各機器を識別
```

### ブリッジ・スイッチの動作

```
【スイッチングハブの動作】

┌─────────────────────────┐
│   スイッチングハブ          │
│  ┌─────────────────┐   │
│  │MACアドレステーブル │   │
│  │ PC-A: ポート1     │   │
│  │ PC-B: ポート2     │   │
│  │ PC-C: ポート3     │   │
│  └─────────────────┘   │
└───┬─────┬─────┬───┘
    │     │     │
 ┌──▼─┐ ┌▼───┐ ┌▼───┐
 │PC-A │ │PC-B │ │PC-C │
 └────┘ └────┘ └────┘

宛先のMACアドレスを見て、
該当するポートにのみデータを送信
→ コリジョン（衝突）を削減
```

---

## 第1層: 物理層 (Physical Layer)

### 役割
- **ビット（0と1）を物理的な電気信号、光信号、電波に変換して伝送**
- ハードウェアの物理的・電気的仕様を定義

### 主な機能
- ビットストリームの送受信
- 電気信号への変換
- 信号の増幅
- ケーブルやコネクタの仕様定義
- 伝送速度の制御
- 物理的接続の確立

### 代表的な規格・技術
| 技術 | 説明 |
|------|------|
| 10BASE-T | 10Mbps イーサネット（ツイストペアケーブル） |
| 100BASE-TX | 100Mbps イーサネット（Fast Ethernet） |
| 1000BASE-T | 1Gbps イーサネット（Gigabit Ethernet） |
| RS-232C | シリアル通信規格 |
| USB | Universal Serial Bus |
| 光ファイバー | 光信号での伝送 |

### 対応する機器・部品
| 機器名 | 説明 |
|--------|------|
| **LANケーブル** | 電気信号を伝送する物理的な配線 |
| **NIC** (物理部分) | データを電気信号に変換してケーブルに流す |
| **リピータ** | 電気信号を増幅して、LANの総延長距離を伸ばす |
| **リピータハブ** | 複数のリピータを束ねた集線装置 |
| 光ファイバーケーブル | 光信号を伝送 |
| 無線送受信機 | 電波での通信 |

### リピータの役割

```
【リピータの動作】

セグメントA        リピータ        セグメントB
    │               │                 │
信号弱まる      信号を増幅        信号が届く
┌───┐          ┌───┐          ┌───┐
│~~~~│  ──→    │████│  ──→    │████│
└───┘          └───┘          └───┘
減衰した信号    増幅           再送出

- LANケーブルの総延長距離には限界がある
- それを超えると信号が歪んで通信不可
- リピータが信号を整形・増幅して再送出
- 欠点: 不要なパケットも全て中継してしまう
```

### セグメントとコリジョン

```
【セグメントの概念】

セグメント = パケットがしらみつぶしに届く範囲

┌────────────────────────┐
│ セグメント1                │
│  PC-A ─┬─ PC-B          │
│        │                   │
│  PC-C ─┘─ PC-D          │
└────────────────────────┘

同一セグメント内では:
- パケットが全ての機器に届く
- 機器が多いとコリジョン（衝突）が発生しやすい
- 回線の利用効率が低下
```

---

## ネットワーク機器とOSI階層の対応表

| 階層 | 層名 | 対応する機器 | 中継するもの |
|------|------|-------------|-------------|
| **第7層〜第4層** | アプリケーション層<br>〜トランスポート層 | **ゲートウェイ** | プロトコル変換を行い、異なるネットワーク同士を中継 |
| **第3層** | ネットワーク層 | **ルータ**<br>**L3スイッチ** | IPアドレス情報を使って、ネットワーク間を中継 |
| **第2層** | データリンク層 | **ブリッジ**<br>**スイッチングハブ**<br>**NIC** | MACアドレス情報を使って、セグメント間を中継 |
| **第1層** | 物理層 | **リピータ**<br>**リピータハブ**<br>**LANケーブル**<br>**NIC** | 電気信号を増幅・送受信 |

---

## データの流れ（カプセル化・デカプセル化）

```
【送信側 - カプセル化】

第7層: アプリケーション層
  │  データ作成
  ▼
第6層: プレゼンテーション層
  │  データ変換・暗号化
  ▼
第5層: セッション層
  │  セッション情報付加
  ▼
第4層: トランスポート層
  │  ┌─────────────────┐
  │  │TCPヘッダ│データ      │ ← セグメント
  │  └─────────────────┘
  ▼
第3層: ネットワーク層
  │  ┌──────────────────────┐
  │  │IPヘッダ│TCPヘッダ│データ│ ← パケット
  │  └──────────────────────┘
  ▼
第2層: データリンク層
  │  ┌───────────────────────────────┐
  │  │Ethernetヘッダ│IPヘッダ│TCPヘッダ│データ│FCS│ ← フレーム
  │  └───────────────────────────────┘
  ▼
第1層: 物理層
  │  010101010101... ← ビット列（電気信号）
  ▼
  ケーブル/無線で伝送


【受信側 - デカプセル化】

  ▲
  │  010101010101...
第1層: 物理層
  ▲
  │  フレームを受信
第2層: データリンク層
  │  Ethernetヘッダを確認・除去
  ▲
  │  パケットを取り出す
第3層: ネットワーク層
  │  IPヘッダを確認・除去
  ▲
  │  セグメントを取り出す
第4層: トランスポート層
  │  TCPヘッダを確認・除去
  ▲
  │  データを再構築
第5層: セッション層
  ▲
第6層: プレゼンテーション層
  │  データを復号化・変換
  ▲
第7層: アプリケーション層
  │  アプリケーションにデータ渡す
```

---

## TCP/IPモデルとOSI参照モデルの対応

```
OSI参照モデル              TCP/IPモデル
┌─────────────┐
│第7層: アプリケーション│      ┌────────────┐
├─────────────┤      │アプリケーション│
│第6層: プレゼンテーション│  ←→  │層           │
├─────────────┤      │             │
│第5層: セッション   │      └────────────┘
├─────────────┤
│第4層: トランスポート│  ←→  ┌────────────┐
│                     │      │トランスポート│
│                     │      │層           │
├─────────────┤      └────────────┘
│第3層: ネットワーク  │  ←→  ┌────────────┐
│                     │      │インターネット│
│                     │      │層           │
├─────────────┤      └────────────┘
│第2層: データリンク  │      ┌────────────┐
├─────────────┤  ←→  │ネットワーク  │
│第1層: 物理         │      │インターフェース│
│                     │      │層           │
└─────────────┘      └────────────┘

OSI: 7階層の理論モデル
TCP/IP: 4階層の実用モデル（実際のインターネットで使用）
```

---

## まとめ

### OSI参照モデルの重要性

1. **標準化**: 異なるメーカーの機器同士が通信できる
2. **トラブルシューティング**: 問題が発生した層を特定しやすい
3. **設計の明確化**: 各層の役割が明確で開発しやすい
4. **教育**: ネットワークの仕組みを理解しやすい

### 覚え方

**上から下へ（第7層→第1層）:**
- **ア**プリケーション層
- **プ**レゼンテーション層
- **セ**ッション層
- **ト**ランスポート層
- **ネ**ットワーク層
- **デ**ータリンク層
- **ブ**ツリ層（物理層）

**語呂合わせ**: 「**ア**ホな**プ**ログラマ**セ**ンセイ**ト**ホホ**ネ**ット**デ**ビュー」

---

## 参考情報

- **出典**:
  - Qiita記事: [ネットワークを構成する装置](https://qiita.com/masatom86650860/items/3b98e47752a61ea9837e)
  - 国際標準化機構（ISO）OSI参照モデル仕様

- **作成日**: 2025年11月15日
- **対象**: ネットワーク学習者、基本情報技術者試験受験者
